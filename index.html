<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andy & Charlotte</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #d6d3d1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a29e; }
        
        .custom-checkbox:checked + div {
            background-color: black;
            border-color: black;
        }
        .custom-checkbox:checked + div svg {
            display: block;
        }
        html { scroll-behavior: smooth; }
        body { overflow-x: hidden; }
        
        /* Hide scrollbar for map panning */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
    </style>
</head>
<body class="bg-stone-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const ChevronDown = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m6 9 6 6 6-6"/></svg>;
        const ChevronUp = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m18 15-6-6-6 6"/></svg>;
        const Users = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>;
        const Heart = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>;
        const Clock = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>;
        const SearchIcon = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>;
        const XIcon = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
        const CheckIcon = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"></polyline></svg>;
        const UserIcon = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>;
        const MapPin = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>;
        const ExternalLinkIcon = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>;
        const HistoryIcon = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M12 7v5l4 2"/></svg>;
        const ArrowRight = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>;
        const ArrowLeft = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>;
        const Phone = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>;

        // --- VENDOR DATA ---
        const vendors = [
            { role: 'Venue', name: 'Bendooley Estate', contact: 'TBA' },
            { role: 'Makeup Artist', name: 'Yoyo & Mary', contact: 'TBA' },
            { role: 'DJ / Photobooth', name: 'Fave Events', contact: 'TBA' },
            { role: 'Stylist', name: 'Ionst Stylist', contact: 'TBA' },
            { role: 'Photographer', name: 'TBA', contact: 'TBA' },
            { role: 'Videographer', name: 'TBA', contact: 'TBA' },
            { role: 'Transport', name: 'Imperial Hotel Shuttle', contact: 'TBA' },
            { role: 'Celebrant', name: 'TBA', contact: 'TBA' }
        ];

        // --- BRIDE EASTER EGG ---
        const BrideMessage = ({ onClose }) => {
            return (
                <div className="fixed inset-0 bg-rose-50 z-[100] overflow-hidden animate-in fade-in duration-700 flex flex-col items-center justify-center p-8 text-center">
                    <button onClick={onClose} className="absolute top-8 right-8 p-3 bg-rose-200/50 rounded-full hover:bg-rose-200 transition-colors text-rose-800">
                        <XIcon className="w-6 h-6" />
                    </button>
                    <div className="max-w-lg space-y-8 animate-in slide-in-from-bottom-8 duration-1000 delay-150">
                        <div className="flex justify-center mb-6">
                            <div className="p-4 bg-rose-100 rounded-full"><Heart className="w-16 h-16 text-rose-400 fill-rose-200" /></div>
                        </div>
                        <h2 className="text-4xl font-serif text-rose-900 mb-4 tracking-wide">Dearest Charlotte</h2>
                        <div className="space-y-6 text-rose-800 font-light text-lg leading-relaxed">
                            <p className="text-2xl font-serif italic text-rose-700">Take a deep breath.</p>
                            <p>Today is going to be the <span className="font-medium">best day of your life</span>.</p>
                            <p>Be present in every moment. Soak it all in. Look at the people who love you.</p>
                            <p>Don't sweat the small stuff, everything is exactly as it should be.</p>
                        </div>
                        <div className="pt-12"><p className="text-rose-400 text-xs font-mono uppercase tracking-[0.3em]">Enjoy every second</p></div>
                    </div>
                </div>
            );
        };

        // --- CHECKLISTS (Easter Eggs) ---
        const GroomChecklist = ({ onClose }) => {
            const [items, setItems] = useState([
                { id: 1, text: "Suit Jacket & Trousers", checked: false }, { id: 2, text: "White Dress Shirt", checked: false }, { id: 3, text: "Tie / Bow Tie", checked: false }, { id: 4, text: "Belt / Suspenders", checked: false }, { id: 5, text: "Dress Socks (Black)", checked: false }, { id: 6, text: "Dress Shoes (Polished)", checked: false }, { id: 7, text: "Cufflinks", checked: false }, { id: 8, text: "Watch", checked: false }, { id: 9, text: "Wedding Ring!", checked: false }, { id: 10, text: "Vows / Speech", checked: false }, { id: 11, text: "Deodorant / Cologne", checked: false }, { id: 12, text: "Hair Product", checked: false }
            ]);
            const toggleItem = (id) => setItems(items.map(item => item.id === id ? { ...item, checked: !item.checked } : item));
            const progress = Math.round((items.filter(i => i.checked).length / items.length) * 100);
            return (
                <div className="fixed inset-0 bg-black text-white z-[100] overflow-y-auto animate-in fade-in duration-300">
                    <div className="max-w-2xl mx-auto p-8">
                        <div className="flex justify-between items-start mb-4">
                            <div><h2 className="text-4xl font-serif mb-2 text-white">The Essentials</h2><p className="text-stone-400 font-mono text-sm tracking-widest uppercase">Groom Protocol</p></div>
                            <button onClick={onClose} className="p-2 bg-stone-900 rounded-full hover:bg-stone-800 transition-colors"><XIcon className="w-6 h-6 text-white" /></button>
                        </div>
                        <div className="sticky top-0 z-30 bg-black pb-8 pt-4 mb-4 border-b border-stone-900">
                            <div className="flex justify-between text-xs font-mono mb-2 uppercase tracking-wider text-stone-500">
                                <span>{progress === 100 ? "Let's go get married!" : "Readiness"}</span>
                                <span>{progress}%</span>
                            </div>
                            <div className="h-1 bg-stone-900 rounded-full overflow-hidden"><div className="h-full bg-white transition-all duration-500 ease-out" style={{ width: `${progress}%` }}></div></div>
                        </div>
                        <div className="space-y-4">{items.map(item => (<label key={item.id} className="group flex items-center p-4 bg-stone-900/50 border border-stone-800 rounded-xl cursor-pointer hover:border-stone-600 transition-all"><input type="checkbox" className="hidden custom-checkbox" checked={item.checked} onChange={() => toggleItem(item.id)} /><div className="w-6 h-6 border-2 border-stone-600 rounded-md flex items-center justify-center mr-4 transition-colors group-hover:border-stone-500"><CheckIcon className="w-4 h-4 text-black hidden" /></div><span className={`text-lg font-light tracking-wide transition-opacity ${item.checked ? 'opacity-30 line-through decoration-stone-500' : 'opacity-100'}`}>{item.text}</span></label>))}</div>
                        <div className="mt-12 text-center"><p className="text-stone-600 text-xs font-mono uppercase tracking-[0.2em]">Don't Forget the Rings</p></div>
                    </div>
                </div>
            );
        };

        const GroomsmenChecklist = ({ onClose }) => {
            const [items, setItems] = useState([
                { id: 1, text: "Suit Up & Look Sharp", checked: false }, { id: 2, text: "Straighten Tie", checked: false }, { id: 3, text: "BoutonniÃ¨re Check (Don't crush it)", checked: false }, { id: 4, text: "Flask Filled (Optional)", checked: false }, { id: 5, text: "Speech Printed/Ready", checked: false }, { id: 6, text: "Sunglasses", checked: false }, { id: 7, text: "Hype the Groom", checked: false }, { id: 8, text: "Keep Groom Hydrated", checked: false }, { id: 9, text: "Dance Moves Prepared", checked: false }, { id: 10, text: "Escort Guests", checked: false }
            ]);
            const toggleItem = (id) => setItems(items.map(item => item.id === id ? { ...item, checked: !item.checked } : item));
            const progress = Math.round((items.filter(i => i.checked).length / items.length) * 100);
            return (
                <div className="fixed inset-0 bg-zinc-800 text-white z-[100] overflow-y-auto animate-in fade-in duration-300">
                    <div className="max-w-2xl mx-auto p-8">
                        <div className="flex justify-between items-start mb-4">
                            <div><h2 className="text-4xl font-serif mb-2 text-white">The Squad</h2><p className="text-zinc-400 font-mono text-sm tracking-widest uppercase">Groomsmen Duties</p></div>
                            <button onClick={onClose} className="p-2 bg-zinc-700 rounded-full hover:bg-zinc-600 transition-colors"><XIcon className="w-6 h-6 text-white" /></button>
                        </div>
                        <div className="sticky top-0 z-30 bg-zinc-800 pb-8 pt-4 mb-4 border-b border-zinc-700">
                            <div className="flex justify-between text-xs font-mono mb-2 uppercase tracking-wider text-zinc-400">
                                <span>{progress === 100 ? "Let's get Andy married!" : "Readiness"}</span>
                                <span>{progress}%</span>
                            </div>
                            <div className="h-1 bg-zinc-900 rounded-full overflow-hidden"><div className="h-full bg-white transition-all duration-500 ease-out" style={{ width: `${progress}%` }}></div></div>
                        </div>
                        <div className="space-y-4">{items.map(item => (<label key={item.id} className="group flex items-center p-4 bg-zinc-700/50 border border-zinc-600 rounded-xl cursor-pointer hover:border-zinc-500 transition-all"><input type="checkbox" className="hidden custom-checkbox" checked={item.checked} onChange={() => toggleItem(item.id)} /><div className="w-6 h-6 border-2 border-zinc-500 rounded-md flex items-center justify-center mr-4 transition-colors group-hover:border-zinc-400"><CheckIcon className="w-4 h-4 text-zinc-800 hidden" /></div><span className={`text-lg font-light tracking-wide transition-opacity ${item.checked ? 'opacity-30 line-through decoration-zinc-500' : 'opacity-100'}`}>{item.text}</span></label>))}</div>
                        <div className="mt-12 text-center"><p className="text-zinc-500 text-xs font-mono uppercase tracking-[0.2em]">Keep the Vibes High</p></div>
                    </div>
                </div>
            );
        };

        // --- MAIN APP ---
        const WeddingTimeline = () => {
            const [expandedEvent, setExpandedEvent] = useState(null);
            const [selectedFilters, setSelectedFilters] = useState(['all']);
            const [searchQuery, setSearchQuery] = useState('');
            const [expandAll, setExpandAll] = useState(false);
            const [currentTime, setCurrentTime] = useState(new Date());
            const [countdown, setCountdown] = useState({ days: 0, hours: 0, minutes: 0, seconds: 0 });
            
            const [showFilters, setShowFilters] = useState(false);
            const [showPastEvents, setShowPastEvents] = useState(false); 
            const [testTime, setTestTime] = useState(null); 
            const [showDevTools, setShowDevTools] = useState(false); 

            // SWIPE & VIEW STATE
            const [view, setView] = useState('timeline'); // 'map', 'timeline', 'vendors'
            const [touchStart, setTouchStart] = useState(null);
            const [touchEnd, setTouchEnd] = useState(null);
            
            // MAP ZOOM STATE
            const [mapZoom, setMapZoom] = useState(false);

            const [groomClickCount, setGroomClickCount] = useState(0);
            const [showGroomChecklist, setShowGroomChecklist] = useState(false);
            const [groomsmenClickCount, setGroomsmenClickCount] = useState(0);
            const [showGroomsmenChecklist, setShowGroomsmenChecklist] = useState(false);
            const [brideClickCount, setBrideClickCount] = useState(0); 
            const [showBrideMessage, setShowBrideMessage] = useState(false); 

            const activeTime = testTime || currentTime; 
            const activeRef = useRef(null); 

            const weddingDate = new Date('2026-02-13T00:00:00');

            // SWIPE HANDLERS
            const minSwipeDistance = 50;
            
            const onTouchStart = (e) => {
                setTouchEnd(null);
                setTouchStart(e.targetTouches[0].clientX);
            };

            const onTouchMove = (e) => {
                setTouchEnd(e.targetTouches[0].clientX);
            };

            const onTouchEnd = () => {
                if (!touchStart || !touchEnd) return;
                const distance = touchStart - touchEnd;
                const isLeftSwipe = distance > minSwipeDistance;
                const isRightSwipe = distance < -minSwipeDistance;
                
                // Left Swipe (Move Right -> Left)
                if (isLeftSwipe) {
                    if (view === 'timeline') setView('vendors');
                    if (view === 'map') setView('timeline');
                }
                
                // Right Swipe (Move Left -> Right)
                if (isRightSwipe) {
                    if (view === 'timeline') setView('map');
                    if (view === 'vendors') setView('timeline');
                }
            };

            // ENABLE DEV TOOLS
            useEffect(() => {
                const params = new URLSearchParams(window.location.search);
                if (params.has('test')) {
                    setShowDevTools(true);
                }
            }, []);

            useEffect(() => { const timer = setInterval(() => setCurrentTime(new Date()), 60000); return () => clearInterval(timer); }, []);

            // AUTO-SCROLL TO TOP ON VIEW CHANGE
            useEffect(() => {
                window.scrollTo({ top: 0, left: 0, behavior: 'instant' });
                
                if (activeRef.current && view === 'timeline') {
                    setTimeout(() => {
                        activeRef.current.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }, 500); 
                }
            }, [view]);

            useEffect(() => {
                const updateCountdown = () => {
                    const now = new Date();
                    const difference = weddingDate.getTime() - now.getTime();
                    if (difference > 0) {
                        setCountdown({
                            days: Math.floor(difference / (1000 * 60 * 60 * 24)),
                            hours: Math.floor((difference / (1000 * 60 * 60)) % 24),
                            minutes: Math.floor((difference / 1000 / 60) % 60),
                            seconds: Math.floor((difference / 1000) % 60)
                        });
                    } else { setCountdown({ days: 0, hours: 0, minutes: 0, seconds: 0 }); }
                };
                updateCountdown();
                const timer = setInterval(updateCountdown, 1000);
                return () => clearInterval(timer);
            }, []);

            const parseEventTime = (timeStr) => {
                const [time, period] = timeStr.split(' ');
                let [hours, minutes] = time.split(':').map(Number);
                if (period === 'PM' && hours !== 12) hours += 12;
                if (period === 'AM' && hours === 12) hours = 0;
                return hours * 60 + minutes; 
            };

            const isWeddingDay = true; 
            const currentMinutes = activeTime.getHours() * 60 + activeTime.getMinutes();

            // *** EVENTS LIST ***
            const events = [
                {
                    id: 1,
                    time: '6:30 AM',
                    title: 'Wake Up & Get Ready!',
                    description: 'Everyone wakes up at the Airbnb. Time to brush teeth and get the day started!',
                    location: 'Burradoo Airbnb',
                    responsible: ['Charlotte', 'Andrew'],
                    teams: ['all'],
                    image: null,
                    links: [{ text: "Google Drive Photos", url: "https://drive.google.com/drive/folders/1maYcB5LFPvCIUy2gbR0_EikSpoEw7NG9" }]
                },
                {
                    id: 2,
                    time: '7:00 AM',
                    title: 'Hair and Make Up Start',
                    description: [
                        { type: 'paragraph', text: 'Makeup Artists Yoyo and Mary arrive. Please have clean faces!' },
                        { type: 'list', items: [
                            '7:00am: Bridesmaid 1 (Wing) - Hair',
                            '7:00am: Bridesmaid 3 (Jess) - Makeup',
                            '7:30am: Bridesmaid 2 (Alison) - Hair',
                            '7:45am: Bridesmaid 1 (Wing) - Makeup'
                        ]}
                    ],
                    location: 'Burradoo Airbnb',
                    responsible: ['Charlotte'],
                    teams: ['bridesmaids'],
                    image: null,
                    links: []
                },
                {
                    id: 3,
                    time: '8:00 AM',
                    title: 'Hair and Make Up - Part 2',
                    description: [
                        '8:00am: Bridesmaid 3 (Jess) - Hair',
                        '8:30am: Bridesmaid 4 (Janice) - Hair',
                        '8:30am: Bridesmaid 2 (Alison) - Makeup'
                    ],
                    location: 'Burradoo Airbnb',
                    responsible: ['Charlotte'],
                    teams: ['bridesmaids'],
                    image: null,
                    links: []
                },
                {
                    id: 4,
                    time: '8:30 AM',
                    title: 'Breakfast Setup & Decor',
                    description: [
                        'Brides/Groomsman start helping with Breakfast setup',
                        'Brides/Groomsman start helping with Tea Ceremony setup',
                        'Bridesmaids start steaming dresses + veil'
                    ],
                    location: 'Burradoo Airbnb',
                    responsible: ['Yunho', 'Alison'],
                    teams: ['bridesmaids', 'groomsmen'],
                    image: null,
                    links: []
                },
                {
                    id: 5,
                    time: '9:00 AM',
                    title: 'Hair and Make Up - Mums',
                    description: [
                        '9:00am: Mum 1 - Hair',
                        '9:15am: Bridesmaid 4 (Janice) - Makeup',
                        '9:30am: Mum 2 - Hair',
                        'Bridesmaids start steaming dresses'
                    ],
                    location: 'Burradoo Airbnb',
                    responsible: ['Charlotte'],
                    teams: ['bridesmaids', 'parents'],
                    image: null,
                    links: []
                },
                {
                    id: 6,
                    time: '9:30 AM',
                    title: 'Groomsmen to begin getting ready & packing',
                    description: [
                        { type: 'paragraph', text: 'Groomsmen need to be fully packed and ready to go. The shuttle waits for no one!' },
                        { type: 'checklist', items: [
                            'Suit & Tie on',
                            'Bags packed for Bendooley',
                            'Outfit changes',
                            'Rings',
                            'Vows'
                        ]},
                        { type: 'paragraph', text: 'Once you are ready, help move the luggage to the front door.' }
                    ],
                    location: 'Burradoo Airbnb',
                    responsible: ['Bryan'],
                    teams: ['bridesmaids', 'groomsmen'],
                    image: null,
                    links: []
                },
                {
                    id: 7,
                    time: '10:00 AM',
                    title: 'The Bride (Charlotte) + Mums Hair & Make Up',
                    description: [
                        '10:00am: Charlotte - Hair & Makeup',
                        '10:00am: Mum 2 - Makeup',
                        '10:45am: Mum 1 - Makeup',
                        'Bridesmaids start steaming dresses and getting ready'
                    ],
                    location: 'Burradoo Airbnb',
                    responsible: ['Charlotte'],
                    teams: ['bride', 'parents'],
                    image: null,
                    links: []
                },
                {
                    id: 8,
                    time: '10:30 AM',
                    title: 'Have you eaten?',
                    description: 'Make sure people have eaten and drank water. Some may start getting ready during this time',
                    location: 'Burradoo Airbnb',
                    responsible: ['All Parties'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 9,
                    time: '11:00 AM',
                    title: 'Everyone is dressed!',
                    description: [
                        'Bridesmaids are dressed',
                        'Groomsmen to get dressed',
                        'Parents are dressed',
                        'Bride and Groom are ready for Tea Ceremony',
                        'Bride and Groom family start to arrive at 11:30am',
                        'Bridesmaids to finalise steaming dresses and veil'
                    ],
                    location: 'Burradoo Airbnb',
                    responsible: ['Charlotte', 'Andrew'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 10,
                    time: '11:30 AM',
                    title: 'Photography & Videography Arrives & Tea Ceremony Setup',
                    description: [
                        { type: 'list', items: [
                            '11:30am: Photographer & Videographer arrive',
                            'Finalise Tea Ceremony decoration setup',
                            'AW/CL Family ensure tea pots and red envelope items are ready'
                        ]},
                        { type: 'checklist', items: [
                            'Tea Pots',
                            'Ingredients',
                            'Cushion',
                            'Space Setup'
                        ]}
                    ],
                    location: 'Burradoo Airbnb',
                    responsible: ['Jess','Janice','Alison'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 11,
                    time: '12:00 PM',
                    title: 'Tea Ceremony Start!',
                    description: [
                        'Doors Open: Bridal team to open door and ask for red pocket',
                        '12:15pm - 1:30pm: Traditional Tea Ceremony',
                        'Charlotte\'s family served first (Mum & Dad, Auntie May & Uncle Jacky, Uncle Daniel)',
                        'Charlotte & Andy need to leave the house with umbrella and come back to the house. Andrew family to be seating at tea ceremony area.',
                        'Andy\'s family to serve next. (Mum & Dad, Alan & Angela)'
                    ],
                    location: 'Burradoo Airbnb',
                    responsible: ['Alison'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 12,
                    time: '1:30 PM',
                    title: 'Final Pack Down & Transport',
                    description: [
                        { type: 'paragraph', text: 'Shuttle arrives at 1:30pm sharp. We depart at 1:45pm. Ensure all items needed for Bendooley is packed and ready to go. May not have time to go back and pick anything missed' },
                        { type: 'checklist', items: [
                            'Rings',
                            'Vows',
                            'Dress Changes',
                            'Speech Scripts',
                            'Bags needed for Reception & Ceremony',
                            'Bridal Kit',
                            'Phone Chargers',
                            'Soju',
                            'Water'
                        ]}
                    ],
                    location: 'Transport to Bendooley',
                    responsible: ['Yunho', 'Ryan'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 13,
                    time: '2:00 PM',
                    title: 'Reception Preparation + Rehersal',
                    description: '2:15pm - 3:30pm: Reception preparation and dry run of the ceremony.',
                    location: 'Bendooley Estate',
                    responsible: ['Charlotte','Andrew'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 14,
                    time: '3:30 PM',
                    title: 'Guest Transport & Reception + Ceremony Setup',
                    description: [
                        { type: 'paragraph', text: '3:30pm: Shuttle picks up guests from Imperial Hotel.' },
                        { type: 'paragraph', text: 'Alison + Ron: Styling setup continues (Book Barn, Floral, Wishing Well).' },
                        { type: 'checklist', items: [
                            'Table Flower',
                            'Flower DIY table',
                            'Wishing well + In loving memory corner + Pokemon cards table',
                            'Table Menus',
                            'Coffee packs + tote bag + personal note (for adults) + place cards',
                            'Key chains (for kids)',
                            'Lamps x 10 for each table',
                            'Candles x 10 sets (2 candles @) for each table',
                            'Drink List',
                            'Photo Booth Props'
                        ]},
                        { type: 'paragraph', text: 'Wing + Jess: Ceremony area set up - flower for late grandparents' },
                        { type: 'paragraph', text: 'Charlotte to change into wedding dress, final touch ups and wedding boutique' }
                    ],
                    location: 'Imperial Hotel / Bendooley',
                    responsible: ['Charlote','Alison','Ron','Wing','Jess'],
                    teams: ['bride','Bridesmaids','Groomsmen','groom'],
                    image: null,
                    links: []
                },
                {
                    id: 15,
                    time: '4:00 PM',
                    title: 'Andy and Charlote First Look + Guest start to arrive',
                    description: [
                        { type: 'paragraph', text: '4:00pm: Andy and Charlotte meet at  - Bridal tree rom for first look with Wing and Jess' },
                        { type: 'paragraph', text: '4:00pm: Guests arrive and are seated. Rest of bridal party to mingle. Water is served to guest before ceremony start.' }
                    ],
                    location: 'Bendooley',
                    responsible: ['Charlotte', 'Andrew'],
                    teams: ['bride', 'groom'],
                    image: null,
                    links: []
                },
                {
                    id: 16,
                    time: '4:30 PM',
                    title: 'Wedding Ceremony',
                    description: [
                        { type: 'paragraph', text: 'The Ceremony will begin!' },
                        { type: 'paragraph', text: 'Entrance Order - Ari, Alison, Janice, Wing, Charlotte + Dad' },
                        { type: 'paragraph', text: 'Group Photo Priority List:' },
                        { type: 'checklist', items: [
                            'Immediate family (AW)',
                            'Immediate family (CL)',
                            'Extended family (CL)',
                            'Bridal Party (ALL)',
                            'Bridal Party (Bridemaids)',
                            'Bridal Party (Groomsmen)',
                            'Dodgeball friends (AW)',
                            'All Parents friends (AW)',
                            'All Parents friends (CL)',
                            'Sam Poon and Fam (CL)',
                            'High school friends (CL) (w/ & w/o spouses & kids)',
                            'Fiona Chan (CL)',
                            'Ballet friends (CL) (w/ & w/o spouses)',
                            'Phoebe Fan & Rachel Lee (CL)',
                            'Christmas at the Kwans friends (CL)',
                            'Nuvei friends (CL)',
                            'Rina & Min (CL)',
                            'MQ friends (AW)',
                        ]}
                    ],
                    location: 'Bendooley Estate',
                    responsible: ['TP'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 17,
                    time: '5:00 PM',
                    title: 'DJ + Photobooth arrives',
                    description: [
                        'FaveEvents - DJ + Photobooth set up at the Book Barn'
                    ],
                    location: 'Book Barn',
                    responsible: ['TP'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 18,
                    time: '5:30 PM',
                    title: 'Aperitivo (Cocktail Hour)',
                    description: [
                        'MC TP to ensure photos are done before heading to food/drinks.',
                        '5:30pm - 6:15pm: Drinks, mingling, and bridal party photos',
                        '5:45pm: Table set up ready at the book barn - Photographers to do styling shots before guest arrive.',
                        '6:15pm: Door opens'
                    ],
                    location: 'Bendooley Estate',
                    responsible: ['TP'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 19,
                    time: '6:00 PM',
                    title: 'Aperitivo (Cocktail Hour) + Reception Table Setting Finalised',
                    description: [
                        'MC TP to ensure photos are done before heading to food/drinks.',
                        '5:30pm - 6:15pm: Drinks, mingling, and bridal party photos',
                        'Remaining bridal party to help usher guest to Book Barn (Do not enter till 6:15pm)',
                        '5:45pm: Aly + Ron - Table set up ready at the book barn - Photographers and Videographers to do styling shots before guest arrive.'
                    ],
                    location: 'Bendooley Estate',
                    responsible: ['TP'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 20,
                    time: '6:30 PM',
                    title: 'Wedding Reception Starts!',
                    description: [
                        { type: 'paragraph', text: 'MC TP to kick off the Reception and get guest seated for the Grand Extrances' },
                        { type: 'paragraph', text: '6:30pm: Grand Entrances! Order: Alison & Bryan, Janice & Yunho, Wing & Jessica, Charlotte & Andrew' },
                        { type: 'paragraph', text: '6:40pm: House keeping' },
                        { type: 'checklist', items: [
                            'TP Introduction',
                            'Bathroom Location',
                            'Table Sharing Menu, Dessert will be served as buffet',
                            'Open Bar',
                            'Floral Station',
                            'Wishing Well',
                            'Pokemon Cards - Write on pokemon side (Guest Book)',
                            'Photobooth till 11pm',
                            'Table Gifts, Coffee Pack, Tote Bag, Personal Notes'
                        ]},
                        { type: 'paragraph', text: '6:40pm: Speeches (Father of Bride, Brother of Groom)' }
                    ],
                    location: 'Book Barn - Reception',
                    responsible: ['TP'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 21,
                    time: '7:00 PM',
                    title: 'Dinner & Charlotte & Andrew Golden Hour Photos',
                    description: [
                        '7:00pm: Sides & Mains served',
                        'Couple golden hour photoshoot'
                    ],
                    location: 'Book Barn - Reception',
                    responsible: ['Charlotte', 'Andrew'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 22,
                    time: '7:30 PM',
                    title: 'Speeches continue! Maid of Honor, Best Woman and Bride & Groom',
                    description: [
                        { type: 'paragraph', text: 'Wait for Bride and Groom to return for Final set of speeches:' },
                        { type: 'checklist', items: [
                            'Maid of Honor - Wing',
                            'Best Woman - Jess',
                            'Bride and Groom Speech'
                        ]}
                    ],
                    location: 'Book Barn - Reception',
                    responsible: ['Wing', 'Andrew','Charlotte','Jess'],
                    teams: ['Bride','Groom','bridesmaids','groomsmen'],
                    image: null,
                    links: []
                },
                {
                    id: 23,
                    time: '8:00 PM',
                    title: 'Dress Change + First Dance',
                    description: [
                        '8:15pm: Charlotte changes dress',
                        '8:20pm: First Dance, Dessert served, and Dance Floor opens!'
                    ],
                    location: 'Book Barn - Reception',
                    responsible: ['Wing', 'Andrew'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 24,
                    time: '8:30 PM',
                    title: 'Dance Floor is Open!',
                    description: [
                        'TIME TO PARTY!'
                    ],
                    location: 'Book Barn - Reception',
                    responsible: ['Guest','DJ'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 25,
                    time: '10:30 PM',
                    title: 'Farewell!',
                    description: [
                        '10:30pm: DJ Announce that Shuttle bus available for international guests',
                        '10:45pm: Party concludes. Pack down begins.'
                    ],
                    location: 'Book Barn - Reception',
                    responsible: ['DJ'],
                    teams: ['all'],
                    image: null,
                    links: []
                },
                {
                    id: 26,
                    time: '11:00 PM',
                    title: 'Bridal Party returns back to Airbnb!',
                    description: [
                        'Party Over! Bridal Party head to shuttle bus.'
                    ],
                    location: 'Airbnb',
                    responsible: ['TP', 'Jess'],
                    teams: ['all'],
                    image: null,
                    links: []
                }
            ];

            // --- RENDER HELPERS ---
            const renderDescriptionContent = (desc) => {
                if (typeof desc === 'string') {
                    return <p className="text-stone-700 mt-4 leading-relaxed">{desc}</p>;
                }
                if (Array.isArray(desc) && typeof desc[0] === 'string') {
                    return (
                        <ul className="text-stone-700 mt-4 leading-relaxed list-none space-y-2">
                            {desc.map((line, idx) => (
                                <li key={idx} className="flex items-start gap-2">
                                    <span className="text-stone-400 mt-1.5 w-1.5 h-1.5 rounded-full bg-stone-300 shrink-0"></span>
                                    <span>{line}</span>
                                </li>
                            ))}
                        </ul>
                    );
                }
                if (Array.isArray(desc) && typeof desc[0] === 'object') {
                    return (
                        <div className="mt-4 space-y-4">
                            {desc.map((section, idx) => {
                                if (section.type === 'paragraph' || section.type === 'text') {
                                    return <p key={idx} className="text-stone-700 leading-relaxed">{section.text || section.content}</p>;
                                }
                                if (section.type === 'list') {
                                    return (
                                        <ul key={idx} className="text-stone-700 leading-relaxed list-none space-y-2 pl-1">
                                            {section.items.map((line, i) => (
                                                <li key={i} className="flex items-start gap-2">
                                                    <span className="text-stone-400 mt-1.5 w-1.5 h-1.5 rounded-full bg-stone-300 shrink-0"></span>
                                                    <span>{line}</span>
                                                </li>
                                            ))}
                                        </ul>
                                    );
                                }
                                if (section.type === 'checklist') {
                                    return (
                                        <div key={idx} className="space-y-2 bg-stone-50 p-3 rounded-lg border border-stone-100">
                                            {section.items.map((item, i) => (
                                                <label key={i} className="flex items-center gap-3 cursor-pointer group">
                                                    <div className="relative flex items-center">
                                                        <input type="checkbox" className="peer appearance-none w-5 h-5 border-2 border-stone-300 rounded bg-white checked:bg-black checked:border-black transition-colors" />
                                                        <CheckIcon className="w-3.5 h-3.5 text-white absolute left-[3px] top-[3px] opacity-0 peer-checked:opacity-100 pointer-events-none" />
                                                    </div>
                                                    <span className="text-sm text-stone-600 group-hover:text-black transition-colors select-none">{item}</span>
                                                </label>
                                            ))}
                                        </div>
                                    );
                                }
                                return null;
                            })}
                        </div>
                    );
                }
                return null;
            };

            const filters = [{id:'all',label:'Everyone',icon:Users},{id:'bride',label:'Bride',icon:Users},{id:'groom',label:'Groom',icon:Users},{id:'bridesmaids',label:'Bridesmaids',icon:Users},{id:'groomsmen',label:'Groomsmen',icon:Users},{id:'parents',label:'Parents',icon:Users}];

            const filteredEvents = events.filter(event => {
                const teamMatch = selectedFilters.includes('all') || event.teams.includes('all') || event.teams.some(team => selectedFilters.includes(team));
                
                const searchTextMatches = (text) => text.toLowerCase().includes(searchQuery.toLowerCase());
                
                let descMatch = false;
                if (typeof event.description === 'string') descMatch = searchTextMatches(event.description);
                else if (Array.isArray(event.description)) {
                    if (typeof event.description[0] === 'string') {
                        descMatch = event.description.some(line => searchTextMatches(line));
                    } else {
                        descMatch = event.description.some(section => {
                            if (section.text) return searchTextMatches(section.text);
                            if (section.items) return section.items.some(item => searchTextMatches(item));
                            return false;
                        });
                    }
                }

                const searchMatch = searchQuery === '' || 
                    searchTextMatches(event.title) || 
                    descMatch ||
                    searchTextMatches(event.location) || 
                    searchTextMatches(event.time) ||
                    (event.responsible && event.responsible.some(r => searchTextMatches(r)));
                
                // Show ALL events regardless of time (logic handled in rendering for visuals)
                return teamMatch && searchMatch;
            });

            // Find first ACTIVE event index for auto-scroll
            const firstActiveIndex = filteredEvents.findIndex(event => {
                const eventMinutes = parseEventTime(event.time);
                return !(isWeddingDay && eventMinutes < currentMinutes - 30);
            });

            const toggleFilter = (filterId) => {
                if (filterId === 'groom') {
                    setGroomsmenClickCount(0); setBrideClickCount(0);
                    const newCount = groomClickCount + 1;
                    setGroomClickCount(newCount);
                    if (newCount >= 4) { setShowGroomChecklist(true); setGroomClickCount(0); setSelectedFilters(['groom']); return; }
                    setSelectedFilters(['groom']); return;
                } 
                if (filterId === 'groomsmen') {
                    setGroomClickCount(0); setBrideClickCount(0);
                    const newCount = groomsmenClickCount + 1;
                    setGroomsmenClickCount(newCount);
                    if (newCount === 5) { setTimeout(() => { setShowGroomsmenChecklist(true); setGroomsmenClickCount(0); }, 800); setSelectedFilters(['groomsmen']); return; }
                    setSelectedFilters(['groomsmen']); return;
                }
                if (filterId === 'bride') {
                    setGroomClickCount(0); setGroomsmenClickCount(0);
                    const newCount = brideClickCount + 1;
                    setBrideClickCount(newCount);
                    // CHANGED TO 3 CLICKS
                    if (newCount >= 3) { setShowBrideMessage(true); setBrideClickCount(0); setSelectedFilters(['bride']); return; }
                    setSelectedFilters(['bride']); return;
                }

                setGroomClickCount(0); setGroomsmenClickCount(0); setBrideClickCount(0);
                if (filterId === 'all') { setSelectedFilters(['all']); } 
                else {
                    setSelectedFilters(prev => {
                        const cleanPrev = prev.filter(f => f !== 'all' && f !== 'groom' && f !== 'groomsmen' && f !== 'bride');
                        if (prev.includes(filterId)) { const newFilters = cleanPrev.filter(f => f !== filterId); return newFilters.length === 0 ? ['all'] : newFilters; } 
                        else { return [...cleanPrev, filterId]; }
                    });
                }
            };

            const handleSearchChange = (e) => { setSearchQuery(e.target.value); setGroomClickCount(0); setGroomsmenClickCount(0); setBrideClickCount(0); };
            const toggleEvent = (id) => { if (!expandAll) { setExpandedEvent(expandedEvent === id ? null : id); } };
            const toggleExpandAll = () => { setExpandAll(!expandAll); if (!expandAll) { setExpandedEvent(null); } };

            // Time Travel Slider Handler
            const handleTimeSliderChange = (e) => {
                const totalMinutes = parseInt(e.target.value);
                const hours = Math.floor(totalMinutes / 60);
                const minutes = totalMinutes % 60;
                const newDate = new Date(weddingDate);
                newDate.setHours(hours);
                newDate.setMinutes(minutes);
                setTestTime(newDate);
            };

            return (
                <div 
                    className="overflow-x-hidden w-full relative min-h-screen"
                    onTouchStart={onTouchStart}
                    onTouchMove={onTouchMove}
                    onTouchEnd={onTouchEnd}
                >
                    {/* --- OVERLAYS MOVED TO ROOT LEVEL TO FIX Z-INDEX ISSUE --- */}
                    {showGroomChecklist && <GroomChecklist onClose={() => setShowGroomChecklist(false)} />}
                    {showGroomsmenChecklist && <GroomsmenChecklist onClose={() => setShowGroomsmenChecklist(false)} />}
                    {showBrideMessage && <BrideMessage onClose={() => setShowBrideMessage(false)} />}

                    {/* --- DESKTOP NAVIGATION ARROWS --- */}
                    <div className="hidden md:block fixed top-1/2 left-8 z-50 transform -translate-y-1/2">
                        {/* LEFT ARROW LOGIC */}
                        {view === 'timeline' && (
                            <button 
                                onClick={() => setView('map')} 
                                className="bg-white/80 backdrop-blur shadow-lg p-4 rounded-full hover:bg-white transition-all hover:scale-110 group border border-stone-100"
                                title="Venue Map"
                            >
                                <ArrowLeft className="w-6 h-6 text-stone-600 group-hover:text-black" />
                            </button>
                        )}
                        {view === 'vendors' && (
                            <button 
                                onClick={() => setView('timeline')} 
                                className="bg-white/80 backdrop-blur shadow-lg p-4 rounded-full hover:bg-white transition-all hover:scale-110 group border border-stone-100"
                                title="Back to Timeline"
                            >
                                <ArrowLeft className="w-6 h-6 text-stone-600 group-hover:text-black" />
                            </button>
                        )}
                    </div>

                    <div className="hidden md:block fixed top-1/2 right-8 z-50 transform -translate-y-1/2">
                        {/* RIGHT ARROW LOGIC */}
                        {view === 'timeline' && (
                            <button 
                                onClick={() => setView('vendors')} 
                                className="bg-white/80 backdrop-blur shadow-lg p-4 rounded-full hover:bg-white transition-all hover:scale-110 group border border-stone-100"
                                title="Vendor List"
                            >
                                <ArrowRight className="w-6 h-6 text-stone-600 group-hover:text-black" />
                            </button>
                        )}
                        {view === 'map' && (
                            <button 
                                onClick={() => setView('timeline')} 
                                className="bg-white/80 backdrop-blur shadow-lg p-4 rounded-full hover:bg-white transition-all hover:scale-110 group border border-stone-100"
                                title="Back to Timeline"
                            >
                                <ArrowRight className="w-6 h-6 text-stone-600 group-hover:text-black" />
                            </button>
                        )}
                    </div>

                    {/* --- SLIDING CONTAINER (300% WIDTH) --- */}
                    <div 
                        className={`flex w-[300%] transition-transform duration-500 ease-in-out`}
                        style={{ transform: `translateX(-${view === 'map' ? 0 : view === 'timeline' ? 33.333 : 66.666}%)` }}
                    >
                        
                        {/* --- VIEW 1: MAP (LEFT) --- */}
                        <div className="w-1/3 shrink-0 h-screen relative bg-stone-100 flex flex-col">
                            <div className="absolute top-6 left-6 z-10">
                                <button 
                                    onClick={() => setView('timeline')}
                                    className="bg-white/90 p-3 rounded-full shadow-md text-stone-600 hover:text-black"
                                >
                                    <ArrowRight className="w-6 h-6" />
                                </button>
                            </div>
                            
                            <div 
                                onClick={() => setMapZoom(!mapZoom)} 
                                className={`flex-1 relative overflow-hidden flex items-center justify-center cursor-zoom-in ${mapZoom ? 'cursor-grab active:cursor-grabbing' : ''}`}
                            >
                                <div className={`transition-all duration-300 w-full h-full ${mapZoom ? 'overflow-auto no-scrollbar' : 'overflow-hidden flex items-center justify-center'}`}>
                                    <img 
                                        src="https://bendooleyestate.com.au/wp-content/uploads/2025/11/new-map.jpg" 
                                        alt="Venue Map" 
                                        className={`transition-transform duration-300 origin-center ${mapZoom ? 'w-[200%] max-w-none' : 'w-full h-full object-contain p-4'}`}
                                    />
                                </div>
                            </div>
                        </div>

                        {/* --- VIEW 2: TIMELINE (CENTER) --- */}
                        <div className="w-1/3 shrink-0">
                            
                            {/* Header */}
                            <header className="bg-white border-b border-stone-200 sticky top-0 z-50 shadow-sm">
                                <div className="max-w-4xl mx-auto px-4 py-6 text-center">
                                    <h1 className="text-4xl font-serif text-black mb-2">Andy & Charlotte</h1>
                                    <p className="text-stone-600 font-light tracking-wide">February 13, 2026</p>
                                    
                                    {countdown.days > 0 || countdown.hours > 0 || countdown.minutes > 0 ? (
                                        <div className="mt-4 flex items-center justify-center gap-4">
                                            <Clock className="w-4 h-4 text-stone-400" />
                                            <div className="flex gap-3 text-sm">
                                                {countdown.days > 0 && <div className="flex flex-col items-center"><span className="text-2xl font-serif text-black">{countdown.days}</span><span className="text-xs text-stone-500 uppercase tracking-wide">Days</span></div>}
                                                <div className="flex flex-col items-center"><span className="text-2xl font-serif text-black">{countdown.hours}</span><span className="text-xs text-stone-500 uppercase tracking-wide">Hours</span></div>
                                                <div className="flex flex-col items-center"><span className="text-2xl font-serif text-black">{countdown.minutes}</span><span className="text-xs text-stone-500 uppercase tracking-wide">Minutes</span></div>
                                                <div className="flex flex-col items-center"><span className="text-2xl font-serif text-black">{countdown.seconds}</span><span className="text-xs text-stone-500 uppercase tracking-wide">Seconds</span></div>
                                            </div>
                                        </div>
                                    ) : isWeddingDay ? (
                                        <div className="mt-4"><p className="text-lg font-serif text-black">Today's the day! ð</p></div>
                                    ) : (
                                        <div className="mt-4"><p className="text-sm text-stone-500">The big day has arrived!</p></div>
                                    )}
                                    
                                    <div className="mt-3 flex items-center justify-center gap-2">
                                        <div className="w-16 h-px bg-gradient-to-r from-transparent via-stone-300 to-transparent"></div>
                                        <Heart className="w-4 h-4 text-stone-400" />
                                        <div className="w-16 h-px bg-gradient-to-r from-transparent via-stone-300 to-transparent"></div>
                                    </div>
                                </div>
                            </header>

                            {/* Filter Bar */}
                            <div className="sticky top-[180px] z-40 bg-white border-b border-stone-200 shadow-sm transition-all duration-300">
                                <div className="max-w-4xl mx-auto px-4">
                                    <button onClick={() => setShowFilters(!showFilters)} className="w-full py-3 flex items-center justify-between text-stone-600 hover:text-black transition-colors">
                                        <div className="flex items-center gap-2"><SearchIcon className="w-4 h-4" /><span className="font-serif text-sm uppercase tracking-wider">Search & Filters</span></div>
                                        {showFilters ? <ChevronUp className="w-5 h-5" /> : <ChevronDown className="w-5 h-5" />}
                                    </button>
                                    {showFilters && (
                                        <div className="pb-4 animate-in slide-in-from-top-2 duration-200">
                                            <div className="mb-4">
                                                <input type="text" placeholder="Search events, locations, or times..." value={searchQuery} onChange={handleSearchChange} className="w-full px-4 py-2 rounded-lg border border-stone-300 focus:outline-none focus:border-black transition-colors"/>
                                            </div>
                                            <div className="flex flex-wrap gap-2 justify-center items-center">
                                                {filters.map(filter => {
                                                    const isGroomWarning = filter.id === 'groom' && groomClickCount === 3;
                                                    const isGroomsmenChill = filter.id === 'groomsmen' && groomsmenClickCount >= 5;
                                                    
                                                    let label = filter.label;
                                                    if (isGroomsmenChill) label = "Okay, Chill!";

                                                    let btnClass = "bg-stone-100 text-stone-700 hover:bg-stone-200";
                                                    if (selectedFilters.includes(filter.id)) btnClass = "bg-black text-white shadow-md";
                                                    if (isGroomWarning) btnClass = "bg-stone-900 text-white shadow-xl scale-105";
                                                    if (isGroomsmenChill) btnClass = "bg-red-700 text-white shadow-xl scale-110 font-bold";

                                                    return (
                                                        <button key={filter.id} onClick={() => toggleFilter(filter.id)} className={`px-4 py-2 rounded-full text-sm font-light tracking-wide transition-all duration-200 ${btnClass}`}>{label}</button>
                                                    );
                                                })}
                                                <div className="w-px h-6 bg-stone-300 mx-2"></div>
                                                <button onClick={toggleExpandAll} className="px-4 py-2 rounded-full text-sm font-light tracking-wide transition-all bg-stone-800 text-white hover:bg-black shadow-md">{expandAll ? 'Collapse All' : 'Expand All'}</button>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* Timeline */}
                            <div className="max-w-3xl mx-auto px-4 py-12 pb-32">
                                <div className="relative">
                                    <div className="absolute left-12 top-0 bottom-0 w-1 bg-stone-300 transform -translate-x-1/2"></div>
                                    <div className="space-y-4">
                                        {filteredEvents.map((event, index) => {
                                            const isExpanded = expandedEvent === event.id || expandAll;
                                            
                                            // *** TIME LOGIC ***
                                            const eventMinutes = parseEventTime(event.time);
                                            const isPast = isWeddingDay && eventMinutes < currentMinutes - 30; // 30 min buffer
                                            const isFirstActive = index === firstActiveIndex;

                                            return (
                                                <div 
                                                    key={event.id} 
                                                    ref={isFirstActive ? activeRef : null} // Attach ref for scrolling
                                                    className={`relative transition-all duration-500 ease-in-out ${isExpanded ? 'flex flex-col items-center gap-4 py-4 z-20' : 'pl-32'} ${isPast ? 'opacity-60 grayscale' : ''}`}
                                                >
                                                    <div className={`transition-all duration-500 ease-in-out z-10 ${isExpanded ? 'relative w-auto transform translate-x-0' : 'absolute left-0 w-24 flex justify-center mt-1'}`}>
                                                        <div className={`px-3 py-2 rounded-lg shadow-md relative transition-colors duration-500 ${isPast ? 'bg-stone-200 text-stone-500' : 'bg-black text-white'}`}>
                                                            <span className="text-sm font-medium tracking-wide">{event.time}</span>
                                                        </div>
                                                    </div>
                                                    <div className={`bg-white rounded-lg shadow-sm border border-stone-200 overflow-hidden hover:shadow-md transition-all duration-500 ease-in-out ${isExpanded ? 'w-[95%] sm:w-[90%] shadow-xl relative z-20' : 'w-full'}`}>
                                                        <button onClick={() => toggleEvent(event.id)} className="w-full px-6 py-4 text-left flex items-center justify-between bg-white">
                                                            <div className="flex-1">
                                                                <h3 className="text-xl font-serif text-black mb-1">{event.title}</h3>
                                                                <div className="flex flex-col gap-1">
                                                                    <div className="flex items-center gap-1.5 text-sm text-stone-500 font-light">
                                                                        <MapPin className="w-3.5 h-3.5" />
                                                                        {event.location}
                                                                    </div>
                                                                    {event.responsible && (
                                                                        <div className="flex items-center gap-1.5 text-xs text-stone-400 font-medium uppercase tracking-wide">
                                                                            <UserIcon className="w-3.5 h-3.5" />
                                                                            {event.responsible.join(', ')}
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            </div>
                                                            {isExpanded ? <ChevronUp className="w-5 h-5 text-stone-600" /> : <ChevronDown className="w-5 h-5 text-stone-600" />}
                                                        </button>
                                                        <div className={`transition-all duration-500 ease-in-out overflow-hidden ${isExpanded ? 'max-h-[2000px] opacity-100' : 'max-h-0 opacity-0'}`}>
                                                            <div className="px-6 pb-6 border-t border-stone-100">
                                                                {renderDescriptionContent(event.description)}
                                                                <div className="mt-4 flex flex-wrap gap-2">{event.teams.map(team => (<span key={team} className="px-3 py-1 bg-stone-100 text-stone-700 text-xs rounded-full border border-stone-200">{team === 'all' ? 'Everyone' : team.charAt(0).toUpperCase() + team.slice(1)}</span>))}</div>
                                                                {event.image && <img src={event.image} alt={event.title} className="mt-4 rounded-lg w-full" />}
                                                                
                                                                {/* --- UPDATED LINK RENDERING --- */}
                                                                {event.links && event.links.length > 0 && (
                                                                    <div className="mt-4 space-y-2">
                                                                        {event.links.map((link, idx) => (
                                                                            <a 
                                                                                key={idx} 
                                                                                href={link.url} 
                                                                                target="_blank" 
                                                                                rel="noopener noreferrer" 
                                                                                className="inline-flex items-center gap-2 text-stone-500 hover:text-black text-sm underline-offset-4 hover:underline transition-colors"
                                                                            >
                                                                                <ExternalLinkIcon className="w-4 h-4" />
                                                                                {link.text}
                                                                            </a>
                                                                        ))}
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>

                            {/* --- TEST TOOL: TIME TRAVEL SLIDER (COMMENTED OUT) --- */}
                            {
                            showDevTools && (
                                <div className="fixed bottom-6 right-6 z-50 bg-white/90 backdrop-blur border border-stone-300 p-4 rounded-xl shadow-2xl w-64">
                                    <p className="text-xs font-bold uppercase tracking-widest text-stone-500 mb-2">Dev: Time Travel</p>
                                    <input 
                                        type="range" 
                                        min="360" max="1440" 
                                        value={(activeTime.getHours() * 60) + activeTime.getMinutes()} 
                                        onChange={handleTimeSliderChange}
                                        className="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-black"
                                    />
                                    <div className="flex justify-between mt-1 text-xs font-mono text-black">
                                        <span>{activeTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>
                                        <button onClick={() => setTestTime(null)} className="underline text-stone-400 hover:text-black">Reset</button>
                                    </div>
                                </div>
                            )}

                            <footer className="bg-white border-t border-stone-200 mt-8">
                                <div className="max-w-4xl mx-auto px-4 py-8 text-center">
                                    <p className="text-stone-600 font-light text-sm">We can't wait to celebrate with you!</p>
                                    <p className="text-stone-500 font-light text-xs mt-2">æ­åç¼è²¡ â¢ ç¾å¹´å¥½å</p>
                                </div>
                            </footer>
                        </div>

                        {/* --- VIEW 3: VENDOR LIST (RIGHT) --- */}
                        <div className="w-1/3 shrink-0 bg-stone-50 min-h-screen relative">
                            <div className="absolute top-6 left-6 z-10">
                                <button 
                                    onClick={() => setView('timeline')}
                                    className="bg-white/90 p-3 rounded-full shadow-md text-stone-600 hover:text-black"
                                >
                                    <ArrowLeft className="w-6 h-6" />
                                </button>
                            </div>
                            
                            <div className="max-w-3xl mx-auto px-4 py-12">
                                <div className="bg-white rounded-2xl shadow-sm border border-stone-200 overflow-hidden">
                                    <div className="px-6 py-8 border-b border-stone-100 bg-stone-50/50">
                                        <h2 className="text-3xl font-serif text-black mb-2">Vendor Directory</h2>
                                        <p className="text-stone-500 text-sm font-light">Key contacts for the big day.</p>
                                    </div>
                                    <div className="divide-y divide-stone-100">
                                        {vendors.map((vendor, idx) => (
                                            <div key={idx} className="p-6 flex items-center justify-between hover:bg-stone-50 transition-colors">
                                                <div>
                                                    <p className="text-xs font-bold uppercase tracking-widest text-stone-400 mb-1">{vendor.role}</p>
                                                    <h3 className="text-lg font-serif text-black">{vendor.name}</h3>
                                                </div>
                                                {vendor.contact && vendor.contact !== 'TBA' ? (
                                                    <a href={`tel:${vendor.contact}`} className="flex items-center gap-2 bg-black text-white px-4 py-2 rounded-full text-sm font-medium hover:bg-stone-800 transition-colors">
                                                        <Phone className="w-4 h-4" />
                                                        <span>Call</span>
                                                    </a>
                                                ) : (
                                                    <span className="text-xs text-stone-400 font-mono bg-stone-100 px-3 py-1 rounded-full">TBA</span>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                
                                <div className="mt-8 text-center">
                                    <button 
                                        onClick={() => setView('timeline')}
                                        className="text-stone-500 hover:text-black text-sm flex items-center justify-center gap-2 mx-auto transition-colors"
                                    >
                                        <ArrowLeft className="w-4 h-4" />
                                        Back to Timeline
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<WeddingTimeline />);
    </script>
</body>
</html>
